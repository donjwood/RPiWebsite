<!DOCTYPE html>
<html>
    <head>
        <% include ../partials/head %>
    </head>
    <body>
        <header>
            <% include ../partials/header %>
        </header>
        <main>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <h1>Raspberry Pi <%= raspberryPiName %></h1>
                    </div>
                </div>
                <div id="senseHatApp" v-cloak>
                    <div class="row">
                        <div class="col-12">
                            <h2>Sense Hat Data</h2>
                        </div>
                    </div>
                    <div class="row" v-if="isLoading">
                        <div class="col-12 large-wait-spinner">
                            <i class="fas fa-circle-notch fa-spin"></i>
                            Fetching Sense Hat Data
                        </div>
                    </div>
                    <div class="row" v-if="!isLoading">
                        <div class="col-12">
                            CPU Temp: {{ celsiusToFahrenheit(senseHatData.cpuTemp).toFixed(1) }} F<br/>
                            Temperature: {{ celsiusToFahrenheit(senseHatData.temperature).toFixed(1) }} F<br/>
                            Pressure: {{ mbarToInHg(senseHatData.pressure).toFixed(2) }} inHg <br/>
                            Temp from Pressure Sensor: {{ celsiusToFahrenheit(senseHatData.temperatureFromPressure).toFixed(1) }} F<br/>
                            Humidity: {{ senseHatData.humidity.toFixed(1) }}%<br/>
                            Pitch: {{ senseHatData.pitch.toFixed(1) }}<br/>
                            Roll: {{ senseHatData.roll.toFixed(1) }}<br/>
                            Yaw: {{ senseHatData.yaw.toFixed(1) }}
                        </div>
                    </div>
                </div>
            </div>  
        </main>
    </body>
    <footer>
            <% include ../partials/footer %>
    </footer>
    <script>
        var senseHatApp = new Vue({
            el: '#senseHatApp',
            data: {
                senseHatData: {
                    cpuTemp: 0,
                    temperature: 0,
                    pressure: 0,
                    temperatureFromPressure: 0,
                    humidity: 0,
                    pitch: 0,
                    roll: 0,
                    yaw: 0
                },
                isLoading: false
            },
            created: function () {
                var vueObject = this;
                this.isLoading = true;
                axios
                .get('/sensehatapi/getsensehatdata')
                .then(function(response) {
                    vueObject.senseHatData = response.data;
                    vueObject.isLoading = false;
                });
            }
        });
    </script>
</html>